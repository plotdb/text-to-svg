<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldui/ldui.min.css"><style type="text/css">html,
body {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
}
@font-face {
  font-family: 'pridi';
  src: url("/assets/font/pridi.ttf") format('truetype');
}
</style></head><body><div class="p-4 h-100"><div class="d-flex flex-column h-100"><div class="mb-2"><textarea class="form-control" ld="edit" rows="5"></textarea></div><div class="flex-grow-1"><svg class="w-100 h-100 border" ld="svg"><text dominant-baseline="hanging" font-size="32" font-family="pridi">ok
how are you</text></svg></div></div></div><script type="text/javascript" src="/assets/lib/ldui/ldui.min.js"></script><script type="text/javascript" src="/assets/lib/opentype.js/opentype.min.js"></script><script type="text/javascript" src="/assets/lib/tts/ol.bundle.min.js"></script><script>// Generated by LiveScript 1.3.1
var textToSvg, opentypeLayout;
console.log(">", opentype);
textToSvg = require("text-to-svg");
opentypeLayout = require("opentype-layout");
console.log(opentypeLayout);
opentype.load("/assets/font/pridi.ttf", function(e, font){
  var scale, result, svg, g, t1, i$, i, j$, j, t2, to$, d, p, pos, s, results$ = [];
  scale = 1 / font.unitsPerEm * 3;
  result = opentypeLayout(font, "ok\nhow are you", {
    lineHeight: 1 * font.unitsPerEm,
    width: 500 / scale
  });
  console.log(">", result);
  window.result = result;
  svg = ld$.find('[ld=svg]', 0);
  g = result.glyphs[0];
  t1 = Date.now();
  for (i$ = 0; i$ < 10; ++i$) {
    i = i$;
    for (j$ = 0; j$ < 10; ++j$) {
      j = j$;
      g.data.path.toPathData();
    }
  }
  t2 = Date.now();
  console.log((t2 - t1) / 1000);
  for (i$ = 0, to$ = result.glyphs.length; i$ < to$; ++i$) {
    i = i$;
    g = result.glyphs[i];
    d = g.data.path.toPathData();
    p = ld$.create({
      ns: 'svg',
      name: 'path'
    });
    p.setAttribute('d', d);
    pos = g.position;
    s = 32 / font.unitsPerEm;
    p.setAttribute('transform', "scale(" + s + ",-" + s + ") translate(" + pos[0] + "," + pos[1] + ")");
    results$.push(svg.appendChild(p));
  }
  return results$;
});
/*
text-to-svg.load "/assets/font/pridi.ttf", (e, tts) ->
  view = new ldView do
    root: document.body
    action: input: do
      edit: ({node, evt}) ->
        svg = view.get(\svg)
        for i from Array.from(svg.childNodes).length - 1 to 0 by -1 =>
          svg.removeChild svg.childNodes[i]
        ret = tts.getD(view.get(\edit).value)
        path = ld$.create ns: \svg, name: \path
        path.setAttribute \d, ret
        svg.appendChild path
        box = path.getBoundingClientRect!
        [x,y] = [box.width, box.height]
        path.setAttribute \transform, "translate(0, #y)"
*/</script></body></html>