<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldui/ldui.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldresize/ldr.min.css"><style type="text/css">html,
body {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
}
@font-face {
  font-family: 'pridi';
  src: url("/assets/font/pridi.ttf") format('truetype');
}
@font-face {
  font-family: 'pacifico';
  src: url("/assets/font/pacifico.ttf") format('truetype');
}
</style></head><body><div class="p-4 h-100"><div class="d-flex flex-column h-100"><div class="mb-2"><textarea class="form-control" ld="edit" rows="5">Hello
World!</textarea></div><div class="flex-grow-1 position-relative"><svg class="w-100 h-100 border position-absolute" ld="svg"></svg><svg class="w-100 h-100 border position-absolute" ld="svg2"><rect x="100" y="100" height="100" width="100" fill="none" stroke="#000" stroke-width="2"></rect></svg><div class="position-absolute" ld="content" contenteditable style="caret-color:#000;color:rgba(0,0,0,0);font-size:64px;font-family:pacifico;transform:translate(200,200)">Hello</div></div></div></div><script type="text/javascript" src="/assets/lib/ldui/ldui.min.js"></script><script type="text/javascript" src="/assets/lib/opentype.js/opentype.min.js"></script><script type="text/javascript" src="/assets/lib/tts/ol.bundle.min.js"></script><script type="text/javascript" src="/assets/lib/ldresize/ldr.min.js"></script><script type="text/javascript" src="/js/tts.js"></script><script>// Generated by LiveScript 1.3.1
var svg, svg2, colors, update, view, ldr;
svg = ld$.find('[ld=svg]', 0);
svg2 = ld$.find('[ld=svg2]', 0);
colors = ['#f00', '#f90', '#ff0', '#9f0', '#0f0', '#0f9', '#0ff', '#09f', '#00f', '#90f', '#f0f', '#f09'];
update = function(){
  var i$, i, cnode, style, opt;
  for (i$ = Array.from(svg.childNodes).length - 1; i$ >= 0; --i$) {
    i = i$;
    svg.removeChild(svg.childNodes[i]);
  }
  tts(view.get('edit').value, {
    container: svg,
    font: 'pacifico',
    fontSize: 32,
    lineHeight: 1
  }).then(function(paths){
    return paths.map(function(d, i){
      return d.setAttribute('fill', colors[i % colors.length]);
    });
  });
  cnode = view.get('content');
  style = window.getComputedStyle(cnode);
  opt = {
    font: 'pacifico',
    fontSize: +style.fontSize.replace(/[^0-9]+/g, ''),
    lineHeight: +style.lineHeight.replace(/[^0-9]+/g, '') / +style.fontSize.replace(/[^0-9]+/g, ''),
    width: style.width.replace(/[^0-9]+/g, '')
  };
  return tts(cnode.innerText, opt).then(function(paths){
    var g, box, rbox, ref$, x, y;
    g = ld$.create({
      ns: 'svg',
      name: 'g'
    });
    box = cnode.getBoundingClientRect();
    rbox = svg.getBoundingClientRect();
    ref$ = [box.x - rbox.x, box.y - rbox.y], x = ref$[0], y = ref$[1];
    g.setAttribute('transform', "translate(" + x + ", " + y + ")");
    svg.appendChild(g);
    return paths.map(function(d, i){
      g.appendChild(d);
      return d.setAttribute('fill', colors[i % colors.length]);
    });
  });
};
view = new ldView({
  root: document.body,
  action: {
    input: {
      edit: function(arg$){
        var node, evt;
        node = arg$.node, evt = arg$.evt;
        return update();
      },
      content: function(arg$){
        var node, evt;
        node = arg$.node, evt = arg$.evt;
        return update();
      }
    }
  }
});
ldr = new ldResize({
  root: svg2,
  host: svg2
});
ldr.attach(ld$.find(svg2, 'rect', 0));
ldr.on('resize', function(){
  var ptr, box, rbox, cnode, ref$, x, y;
  console.log(1);
  ptr = ldr.get();
  box = svg2.getBoundingClientRect();
  rbox = svg2.parentNode.getBoundingClientRect();
  console.log(box, rbox);
  cnode = view.get('content');
  ref$ = [box.x - rbox.x + ptr.t.x - ptr.w * ptr.s.x / 2, box.y - rbox.y + ptr.t.y - ptr.h * ptr.s.y / 2], x = ref$[0], y = ref$[1];
  cnode.style.transform = "translate(" + x + "px," + y + "px)";
  cnode.style.width = ptr.s.x * ptr.w + "px";
  cnode.style.height = ptr.s.y * ptr.h + "px";
  cnode.style.left = ptr.x + "px";
  cnode.style.top = ptr.y + "px";
  return update();
});
update();</script></body></html>